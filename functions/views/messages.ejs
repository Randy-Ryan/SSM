<!DOCTYPE html>
<html>

<head>
    <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-storage.js"></script>
    <title>Messages</title>
    <meta name="description" content="This is the description">
    <link rel="stylesheet" href="./styles.css" />
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="messages.js" defer></script>
</head>

<body>
    <header class="main-header">
        <nav class="main-nav nav">
            <ul>
                <li><a href="index.html">HOME</a></li>
                <li><a href="store">STORE</a></li>
                <li><a href="account.html" id="accountRef">MY ACCOUNT</a></li>
                <li><a href="post.html" id="postRef">NEW POST</a></li>

            </ul>
        </nav>
        <h1 class="band-name band-name-large">SKATE SHOE MATE</h1>
    </header>
    <!-- <div id = "username"></div> -->
    <section class="container content-section">
        <div>
            <h2 class="section-header">Messages</h2>
            <% for (const message in messages) { %>
                <% if((messages[message].userRecieve==username && messages[message].userSend==theirUsername)) { %>
                    <div class="their-message-item" data-item-id="<%= messages[message].docID %>">
                        <span class="shop-item-title">
                            <%- "From " + messages[message].userSend + ": to " + messages[message].userRecieve
                                + " <br><br>" + messages[message].message + " <br><br>(Date: " + messages[message].date
                                + ")" %>
                        </span>
                    </div>
                    <% } %>
                        <% if((messages[message].userRecieve==theirUsername && messages[message].userSend==username)){
                            %>
                            <div class="my-message-item" data-item-id="<%= messages[message].docID %>">
                                <span class="shop-item-title">
                                    <%- "From " + messages[message].userSend + ": to " + messages[message].userRecieve
                                        + " <br><br>" + messages[message].message + " <br><br>(Date: " +
                                        messages[message].date + ")" %>
                                </span>
                            </div>
                            
                            <% } %>
                                <% } %>
        </div>
    </section>
    <br><br><br><br> <br><br><br><br>    <br><br><br><br> <br><br><br><br>

    <section class="container content-section">
        <div class="cart-row">
            <span id="testTheirs" class="shop-item-price">
                <%= "To " + theirUsername %>
            </span>
            <input type="text" id="message" onclick="makeClean(document.getElementById('message'))" name="Message"
                class="requiredMessageInput"
                style="width: 50%; height: 35px; border: 1px solid black; color: black;"><br><br>
            <button onclick="messageUser()" class="messageButton" value="Send Message">SEND MESSAGE</button>
        </div>
        <br><br>
        <button onclick="initExchange()" class="exchangeButton" style="padding: 3%; width: 50%;">  <%- "INITIATE AN EXCHANGE REQUEST WITH " + theirUsername %></button>

        <div class="cart-items">

        </div>

    </section>


</body>

</html>